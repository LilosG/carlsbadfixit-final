---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import QuickEstimateCard from "../../../components/QuickEstimateCard.astro";
import PageCtaStrip from "../../../components/PageCtaStrip.astro";

import { services } from "../../../data/services";
import { serviceAreas } from "../../../data/service-areas";
import { cityContent } from "../../../data/city-content";
import { moneyContent } from "../../../data/money-content";
import type { Service } from "../../../data/services";
import type { ServiceArea } from "../../../data/service-areas";

import {
  getBreadcrumbJsonLd,
  getLocalBusinessJsonLd,
  getCityServiceJsonLd,
  getFaqPageJsonLd,
} from "../../../lib/seo";

// Reuse the same FAQ content model as the core service page.
const faqByService: Record<string, { question: string; answer: string }[]> = {
  "carpentry-woodwork": [
    {
      question:
        "What size carpentry projects are a good fit for a handyman visit?",
      answer:
        "Most visits focus on trim, doors, fences, gates, and small framing or storage projects that can be completed in a clear service window. Larger, multi-room remodels, built-ins that require a shop, or structural changes are usually better suited for a full-service contractor.",
    },
    {
      question: "Do I need to buy my own materials for carpentry projects?",
      answer:
        "You are welcome to provide your own fixtures and materials, or we can source common items locally in North County. For more specialized lumber or hardware, we will confirm options and availability before your visit.",
    },
    {
      question: "Can you help with both interior and exterior wood repairs?",
      answer:
        "Yes. Typical visits combine interior trim and door work with small exterior items such as fence sections and gates, as long as everything fits safely into the scheduled time and does not require major structural work or permits.",
    },
  ],
  electrical: [
    {
      question:
        "What kinds of electrical work are included in a typical visit?",
      answer:
        "Most visits focus on swapping existing light fixtures and fans, adding dimmers and smart switches where wiring allows, and troubleshooting simple issues at a single light, switch, or outlet. Anything that involves new circuits, main panels, or whole-home rewiring is referred to a licensed electrical contractor.",
    },
    {
      question: "Do I need to provide my own light fixtures or fans?",
      answer:
        "Many homeowners prefer to choose their own fixtures and fans. As long as they are compatible with the existing electrical boxes and locations, we are happy to install them and make sure everything is secure and tidy.",
    },
    {
      question: "Can you handle emergency electrical problems?",
      answer:
        "No. Emergency issues such as burning smells, repeated breaker trips, or loss of power to major areas of the home should be handled by a licensed electrician or your utility provider. Our visits are best for planned upgrades and non-urgent, small electrical fixes.",
    },
  ],
  "furniture-assembly-installation": [
    {
      question: "What types of furniture and installations can you help with?",
      answer:
        "Typical visits include assembling flat-pack furniture, desks, beds, and storage, anchoring tall pieces to walls, and installing shelves, artwork, and simple wall décor. We focus on safe, tidy installs that are ready for daily use.",
    },
    {
      question: "Can you help decide where furniture and wall décor should go?",
      answer:
        "If you have a general idea of where things should go, we can help fine-tune placement so it feels centered and practical in the space. For full interior design services, we recommend working with a designer first and then bringing us in for the install work.",
    },
    {
      question: "Do you remove packaging and leftover materials?",
      answer:
        "Yes. Packaging from new furniture and fixtures is collected and staged neatly for your regular trash and recycling service. If a project generates unusually large amounts of material, we will discuss disposal options ahead of time.",
    },
  ],
  "plumbing-fixtures-repairs": [
    {
      question: "What plumbing work is included in a typical visit?",
      answer:
        "Visits are focused on visible fixtures and small leak repairs such as faucet swaps, disposer replacements, running toilets, and accessible drain and supply line issues. Slab leaks, sewer line work, and anything that requires opening large sections of walls are referred to a licensed plumber.",
    },
    {
      question: "Should I buy my own faucets and fixtures first?",
      answer:
        "Most homeowners prefer to select their own faucets, disposers, and trim that match the rest of the home. If you have questions about compatibility before you purchase, you can always share a few photos and we will confirm what will work best.",
    },
    {
      question:
        "Can you work on plumbing in rental properties and small businesses?",
      answer:
        "Yes. Many visits are scheduled for smaller rental homes and local businesses that need basic fixture repairs and replacements to keep kitchens, baths, and break areas presentable.",
    },
  ],
  "honey-do-lists-small-repairs": [
    {
      question: "How many items can we include in one honey-do visit?",
      answer:
        "Most visits are built around a prioritized list of small to medium tasks that can be completed safely within the scheduled time. We group items by room or area so the highest-value fixes are handled first, and anything that does not fit can be clearly noted for a future visit.",
    },
    {
      question:
        "What are examples of tasks that fit well into a honey-do list?",
      answer:
        "Common items include tightening loose hardware, adjusting doors, patching small wall dings, swapping a few fixtures, and touching up caulk or weatherstripping. The goal is to clear the list of small issues that make everyday living more frustrating than it needs to be.",
    },
    {
      question:
        "Is a honey-do visit a good fit before listing a home for sale?",
      answer:
        "Yes. Many North County homeowners schedule a focused visit before listing to tidy obvious cosmetic issues—wall dings, crooked hardware, small repairs—so showings feel cleaner and buyers can focus on the strengths of the home.",
    },
  ],
  "drywall-repair": [
    {
      question: "What size drywall repairs are a good fit?",
      answer:
        "Most visits cover small to medium wall and ceiling damage such as moving-related holes, cracks along seams, and a few larger patches from previous work. Extensive damage, full-room skim coats, or multi-room remodel work is usually better handled by a dedicated drywall crew.",
    },
    {
      question: "Can you match my existing wall texture and paint?",
      answer:
        "We blend new texture into the surrounding area so repairs do not jump out at a glance. Paint touch-up can often be completed when matching paint is available; otherwise we will discuss options based on the existing finish and your goals for the space.",
    },
    {
      question: "Do you handle stains from active leaks?",
      answer:
        "We can repair and refinish drywall after the underlying plumbing or roof issue has been properly fixed and dried out. Active leaks or suspected mold issues should be addressed by a licensed plumber, roofer, or remediation specialist before cosmetic repairs are scheduled.",
    },
  ],
  "tv-mounting": [
    {
      question: "What do I need to have ready for a TV mounting visit?",
      answer:
        "Have the TV, wall mount, and any key components such as a soundbar or streaming device on site. We will confirm mounting locations, find studs or appropriate anchors, and make sure everything is secure and positioned for comfortable viewing.",
    },
    {
      question: "Can you hide all of the cables inside the wall?",
      answer:
        "In many cases we can route and conceal cabling using surface channels or in-wall rated kits designed for low-voltage and power. The exact approach depends on your wall construction, outlet locations, and the components you are using.",
    },
    {
      question: "Is TV mounting a good fit for rental properties?",
      answer:
        "Yes. Solidly mounted TVs with tidy cabling are a common request in rental homes and small multifamily units around North County. We focus on safe installs that balance guest comfort with practical long-term maintenance.",
    },
  ],
};

export function getStaticPaths() {
  const paths: {
    params: { city: string; service: string };
    props: { city: ServiceArea; service: Service };
  }[] = [];

  for (const area of serviceAreas) {
    for (const service of services) {
      paths.push({
        params: { city: area.slug, service: service.slug },
        props: { city: area, service },
      });
    }
  }

  return paths;
}

const { city, service } = Astro.props;

const cityKey = city.slug;

// Primary / default area = Carlsbad (for fallbacks)
const primaryArea =
  serviceAreas.find((area) => area.primary) ?? serviceAreas[0];
const primaryCityKey = primaryArea.slug;

// Money content – prefer city-specific, else fall back to primary area entry.
const cityMoney = moneyContent[cityKey] ?? {};
const primaryMoney = moneyContent[primaryCityKey] ?? {};
const moneyEntry =
  (cityMoney && cityMoney[service.slug]) ||
  (primaryMoney && primaryMoney[service.slug]) ||
  {};

const introText =
  moneyEntry.intro ??
  `Local ${service.name.toLowerCase()} visits in ${city.label} focused on small to medium projects that fit into a clear service window.`;

const schedulingNote =
  moneyEntry.schedulingNote ??
  "Visits are scoped so as much meaningful work as possible fits into a single, clearly defined service window.";

const fitGood: string[] = moneyEntry.fitGood ?? [];
const fitNotGood: string[] = moneyEntry.fitNotGood ?? [];
const localNote = moneyEntry.localNote ?? "";
const audienceNotes = moneyEntry.audienceNotes ?? {};
const reviewSnippet = moneyEntry.reviewSnippet;

const serviceExamples: string[] = service.examples ?? [];

// City-level content – neighborhoods, popular projects, etc.
const cityData = cityContent[cityKey] ?? {};
const neighborhoods: string[] = cityData.neighborhoods ?? [];
const popularProjects = cityData.popularProjects ?? [];

// FAQ items by service
const faqItems = faqByService[service.slug] ?? [];

// SEO
const title = `${service.name} in ${city.label} | Carlsbad Fix It`;
const description = `${service.name} visits in ${city.label} for small to medium projects that fit into a clear service window, handled by a licensed and insured local handyman.`;

const breadcrumbJsonLd = JSON.stringify(
  getBreadcrumbJsonLd([
    { name: "Home", url: "/" },
    { name: "Service areas", url: "/service-areas/" },
    { name: city.label, url: `/service-areas/${city.slug}/` },
    {
      name: service.name,
      url: `/service-areas/${city.slug}/${service.slug}/`,
    },
  ]),
);

const localBusinessJsonLd = JSON.stringify(
  getLocalBusinessJsonLd([city.label]),
);

const serviceJsonLd = JSON.stringify(getCityServiceJsonLd(service, city));

const faqJsonLd =
  faqItems.length > 0
    ? JSON.stringify(
        getFaqPageJsonLd(
          faqItems,
          `/service-areas/${city.slug}/${service.slug}/`,
          title,
        ),
      )
    : null;
---

<BaseLayout title={title} description={description}>
  <script
    type="application/ld+json"
    slot="head"
    is:inline
    set:html={localBusinessJsonLd}
  />
  <script
    type="application/ld+json"
    slot="head"
    is:inline
    set:html={breadcrumbJsonLd}
  />
  <script
    type="application/ld+json"
    slot="head"
    is:inline
    set:html={serviceJsonLd}
  />
  {
    faqJsonLd && (
      <script
        type="application/ld+json"
        slot="head"
        is:inline
        set:html={faqJsonLd}
      />
    )
  }

  {/* HERO – city + service with CTA card */}
  <section
    class="from-cf-accentBlue to-cf-primary shadow-soft relative overflow-hidden rounded-3xl bg-gradient-to-br via-sky-700 px-6 py-8 text-white md:px-10 md:py-10"
  >
    <div class="pointer-events-none absolute inset-0 opacity-25">
      <div
        class="absolute -top-24 -left-32 h-72 w-72 rounded-full bg-white/15 blur-3xl"
      >
      </div>
      <div
        class="absolute right-[-4rem] bottom-[-6rem] h-80 w-80 rounded-full bg-amber-300/25 blur-3xl"
      >
      </div>
    </div>

    <div
      class="relative z-10 grid gap-10 lg:grid-cols-[minmax(0,1.55fr)_minmax(0,1.1fr)] lg:items-start"
    >
      <div class="space-y-6">
        <p class="eyebrow text-amber-200">
          {service.name} in {city.label}
        </p>
        <h1 class="text-display font-semibold tracking-tight text-white">
          {service.name} in {city.label}
        </h1>
        <p class="text-body-sm max-w-2xl text-sky-50">
          {introText}
        </p>

        {
          serviceExamples.length > 0 && (
            <div class="grid gap-3 text-sm text-sky-50 md:grid-cols-2">
              {serviceExamples.slice(0, 4).map((example) => (
                <div class="flex items-start gap-2">
                  <span class="mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bg-amber-300/20 text-[11px] font-semibold text-amber-100">
                    ✓
                  </span>
                  <span class="leading-snug">{example}</span>
                </div>
              ))}
            </div>
          )
        }

        <div class="flex flex-wrap items-center gap-3">
          <a href="#city-service-form" class="btn-primary text-sm">
            Request an estimate
          </a>
          <a
            href="tel:+18082266681"
            data-ga-event="call_click"
            data-ga-label="site_phone"
            class="border-cf-accentBlueSoft to-cf-accentBlueSoft/40 text-cf-accentBlue shadow-soft hover:to-cf-accentBlueSoft/70 inline-flex items-center justify-center rounded-full border bg-gradient-to-r from-white px-5 py-2 text-sm font-semibold hover:from-white"
          >
            Call or text{" "}
            <span class="text-cf-accentBlue ml-1 font-semibold hover:underline">
              (808) 226-6681
            </span>
          </a>
        </div>

        <div
          class="flex flex-wrap items-center gap-x-6 gap-y-3 text-xs text-sky-100 md:text-sm"
        >
          <div class="inline-flex items-center gap-2">
            <span class="h-2 w-2 rounded-full bg-emerald-300"></span>
            <span>Licensed and insured handyman</span>
          </div>
          <div class="inline-flex items-center gap-2">
            <span class="h-2 w-2 rounded-full bg-amber-300"></span>
            <span>Based in Carlsbad, serving North County San Diego</span>
          </div>
          <div class="inline-flex items-center gap-2">
            <span class="h-2 w-2 rounded-full bg-sky-300"></span>
            <span>Focused on small to medium home projects</span>
          </div>
        </div>
      </div>

      <aside class="flex justify-end">
        <div
          id="city-service-form"
          class="text-cf-text shadow-soft w-full max-w-md rounded-3xl bg-white p-5 sm:p-6"
        >
          <QuickEstimateCard
            eyebrow="Get your estimate started"
            title={`Request your ${service.name.toLowerCase()} visit in ${city.label}`}
            body={`Share your location in ${city.label} or a nearby city, a short list of ${service.name.toLowerCase()} tasks, and any helpful photos. You will receive clear next steps and a no-obligation estimate.`}
            defaultCity={city.label}
          />
        </div>
      </aside>
    </div>
  </section>

  {/* TYPICAL VISIT */}
  <section class="mt-8 rounded-3xl bg-amber-50 p-6 md:p-8">
    <div class="space-y-3">
      <p class="eyebrow text-cf-textMuted">Typical visit</p>
      <h2 class="text-h2 text-cf-text font-semibold">
        What a typical {service.name.toLowerCase()} visit includes in {
          city.label
        }
      </h2>
      <p class="text-body-sm text-cf-textMuted max-w-3xl">
        Each visit is scoped so as much meaningful work as possible fits into a
        clear service window. Here are common tasks homeowners ask for in {
          city.label
        } and nearby North County communities.
      </p>
    </div>

    {
      fitGood.length > 0 && (
        <div class="mt-5 grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {fitGood.map((item) => (
            <div class="text-cf-text shadow-soft flex h-full flex-col justify-center rounded-3xl bg-white p-4 text-sm md:p-5">
              <p>{item}</p>
            </div>
          ))}
        </div>
      )
    }

    {
      localNote && (
        <div class="text-cf-textMuted shadow-soft mt-6 rounded-2xl bg-white/70 p-4 text-sm md:p-5">
          <p>{localNote}</p>
        </div>
      )
    }
  </section>

  {/* PRICING / SCHEDULING + WHEN NOT A GOOD FIT */}
  <section
    class="mt-8 grid gap-6 md:grid-cols-[minmax(0,1.6fr)_minmax(0,1.1fr)] md:items-start"
  >
    <div class="shadow-soft space-y-4 rounded-3xl bg-white p-6 md:p-8">
      <p class="eyebrow text-cf-textMuted">Pricing &amp; scheduling</p>
      <h2 class="text-h2 text-cf-text font-semibold">
        How {service.name.toLowerCase()} visits are scheduled in {city.label}
      </h2>
      <p class="text-body-sm text-cf-textMuted">
        {schedulingNote}
      </p>
      <p class="text-body-sm text-cf-textMuted">
        You will always receive clear expectations on scope, timing, and pricing
        before work begins. When several tasks are in the same area of the home,
        they are often combined into a single visit to keep disruption low and
        results high.
      </p>
    </div>

    <aside class="bg-cf-sandSoft space-y-4 rounded-3xl p-6 md:p-7">
      <p class="eyebrow text-cf-textMuted">When this is not a good fit</p>
      <h2 class="text-cf-text text-lg font-semibold">
        Projects better suited for a larger contractor
      </h2>
      {
        fitNotGood.length > 0 ? (
          <ul class="text-cf-textMuted mt-3 space-y-2 text-sm">
            {fitNotGood.map((item) => (
              <li class="flex gap-2">
                <span class="text-cf-primary mt-1 inline-flex h-5 w-5 items-center justify-center rounded-full bg-white text-[11px] font-semibold">
                  ✕
                </span>
                <span>{item}</span>
              </li>
            ))}
          </ul>
        ) : (
          <p class="text-cf-textMuted mt-3 text-sm">
            Very large projects, major structural changes, or anything requiring
            extensive permitting is usually better handled by a full-service
            contractor. We are happy to help you decide what makes the most
            sense once we see your list.
          </p>
        )
      }
      <p class="text-cf-textMuted mt-3 text-xs">
        If your project looks better suited to a specialty trade or larger crew,
        we will be honest about that up front so you do not waste time or
        budget.
      </p>
    </aside>
  </section>

  {/* HOW IT WORKS – 3-step process */}
  <section class="shadow-soft mt-8 rounded-3xl bg-white p-6 md:p-8">
    <div class="space-y-3">
      <p class="eyebrow text-cf-textMuted">How it works</p>
      <h2 class="text-h2 text-cf-text font-semibold">
        A simple 3-step process for {service.name.toLowerCase()} visits in {
          city.label
        }
      </h2>
      <p class="text-body-sm text-cf-textMuted max-w-3xl">
        Clear communication and tidy work from the first message through the
        final walkthrough. The goal is to keep your project moving without
        surprises.
      </p>
    </div>
    <div class="mt-5 grid gap-4 md:grid-cols-3">
      <div
        class="bg-cf-sandSoft text-cf-text shadow-soft rounded-3xl p-5 text-sm"
      >
        <p
          class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
        >
          Step 1
        </p>
        <h3 class="mt-1 font-semibold">Share your project list and photos</h3>
        <p class="text-cf-textMuted mt-2 text-sm">
          Send a brief description of the work, a few photos, and your location
          in{" "}
          {city.label} or another North County city. This helps confirm that a handyman
          visit is the right fit.
        </p>
      </div>
      <div
        class="bg-cf-sandSoft text-cf-text shadow-soft rounded-3xl p-5 text-sm"
      >
        <p
          class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
        >
          Step 2
        </p>
        <h3 class="mt-1 font-semibold">Review your estimate and schedule</h3>
        <p class="text-cf-textMuted mt-2 text-sm">
          You will receive clear expectations on what can be completed, how long
          the visit will take, and how material costs will be handled before you
          commit to anything.
        </p>
      </div>
      <div
        class="bg-cf-sandSoft text-cf-text shadow-soft rounded-3xl p-5 text-sm"
      >
        <p
          class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
        >
          Step 3
        </p>
        <h3 class="mt-1 font-semibold">We complete the visit and clean up</h3>
        <p class="text-cf-textMuted mt-2 text-sm">
          Work is completed with careful protection, tidy work areas, and a
          final walkthrough so you know what was finished and where to look if
          any questions come up later.
        </p>
      </div>
    </div>
  </section>

  {/* AUDIENCE NOTES – who this helps */}
  <section class="shadow-soft mt-8 rounded-3xl bg-white p-6 md:p-8">
    <div
      class="grid gap-6 md:grid-cols-[minmax(0,1.4fr)_minmax(0,1.2fr)] md:items-start"
    >
      <div class="space-y-3">
        <p class="eyebrow text-cf-textMuted">Where this helps most</p>
        <h2 class="text-h2 text-cf-text font-semibold">
          {service.name} help for homeowners and property owners in {city.label}
        </h2>
        <p class="text-body-sm text-cf-textMuted">
          Many visits are scheduled in {city.label} and nearby communities such as{
            " "
          }
          {
            serviceAreas
              .filter((a) => a.slug !== cityKey)
              .map((a) => a.name)
              .join(", ")
          }
          . Availability in each area depends on schedule and project mix.
        </p>
      </div>

      <div
        class="bg-cf-sandSoft text-cf-text space-y-3 rounded-3xl p-5 text-sm md:p-6"
      >
        <div class="space-y-2">
          <p
            class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
          >
            Homeowners
          </p>
          <p class="text-cf-textMuted text-sm">
            {
              audienceNotes.homeowners ??
                "Focused on small to medium projects that make everyday living easier—tightening up details, improving comfort, and handling the list of small tasks that never seems to shrink."
            }
          </p>
        </div>
        <div class="space-y-2">
          <p
            class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
          >
            Rentals &amp; small portfolios
          </p>
          <p class="text-cf-textMuted text-sm">
            {
              audienceNotes.rentals ??
                "Turnover touch-ups and small repairs for smaller rental homes, ADUs, and long-term rentals so units feel clean, functional, and ready for the next lease or stay."
            }
          </p>
        </div>
        <div class="space-y-2">
          <p
            class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase"
          >
            Local businesses
          </p>
          <p class="text-cf-textMuted text-sm">
            {
              audienceNotes.businesses ??
                "Light repairs and improvement projects for offices, studios, and storefronts that want a tidy result without a large project crew on site."
            }
          </p>
        </div>
      </div>
    </div>
  </section>

  {/* COVERAGE / NEIGHBORHOODS */}
  <section class="bg-cf-sandSoft mt-8 rounded-3xl p-6 md:p-8">
    <div class="space-y-3">
      <p class="eyebrow text-cf-textMuted">Coverage in {city.label}</p>
      <h2 class="text-h2 text-cf-text font-semibold">
        Where we offer {service.name.toLowerCase()} services in {city.label}
      </h2>
      <p class="text-body-sm text-cf-textMuted max-w-3xl">
        Carlsbad Fix It is based in {primaryArea.label} with carefully selected availability
        in {city.label} and other nearby North County San Diego communities. Travel
        is planned so most of your visit can be spent on actual work instead of time
        on the road.
      </p>
    </div>

    {
      neighborhoods.length > 0 && (
        <div class="mt-5">
          <p class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase">
            Neighborhoods often served in {city.label}
          </p>
          <div class="text-cf-text mt-2 flex flex-wrap gap-2 text-[11px]">
            {neighborhoods.map((name) => (
              <span class="shadow-soft inline-flex items-center rounded-full bg-white px-3 py-1">
                {name}
              </span>
            ))}
          </div>
        </div>
      )
    }

    {
      popularProjects.length > 0 && (
        <div class="shadow-soft mt-6 rounded-3xl bg-white p-5">
          <p class="text-cf-textMuted text-xs font-semibold tracking-wide uppercase">
            Popular projects in {city.label}
          </p>
          <div class="mt-3 grid gap-3 md:grid-cols-2">
            {popularProjects.map((project) => (
              <div class="bg-cf-card text-cf-text shadow-soft rounded-2xl p-4 text-xs">
                <h3 class="text-cf-text text-sm font-semibold">
                  {project.title}
                </h3>
                <p class="text-cf-textMuted mt-1 text-xs">{project.summary}</p>
              </div>
            ))}
          </div>
        </div>
      )
    }
  </section>

  {/* TESTIMONIAL – from moneyContent snippet if present */}
  {
    reviewSnippet && (
      <section class="shadow-soft mt-8 rounded-3xl bg-white p-6 md:p-8">
        <div class="space-y-4">
          <div class="space-y-2">
            <p class="eyebrow text-cf-textMuted">{city.name} reviews</p>
            <h2 class="text-h2 text-cf-text font-semibold">
              What homeowners say about {service.name.toLowerCase()} visits in{" "}
              {city.label}
            </h2>
          </div>
          <div class="grid gap-4 md:grid-cols-2">
            <figure class="bg-cf-card shadow-soft rounded-3xl p-5 text-sm md:p-6">
              <p class="text-cf-textMuted text-[13px] italic">
                “{reviewSnippet.quote}”
              </p>
              <figcaption class="text-cf-text mt-3 text-sm">
                <p class="font-semibold">{reviewSnippet.name}</p>
                <p class="text-cf-textMuted">
                  {reviewSnippet.location}
                  {reviewSnippet.role ? " · " + reviewSnippet.role : ""}
                </p>
              </figcaption>
            </figure>
          </div>
        </div>
      </section>
    )
  }

  {/* FAQ */}
  {
    faqItems.length > 0 && (
      <section
        id="faq"
        class="shadow-soft mt-8 rounded-3xl bg-white p-6 md:p-8"
      >
        <div class="space-y-3">
          <p class="eyebrow text-cf-textMuted">
            Questions from North County homeowners
          </p>
          <h2 class="text-h2 text-cf-text font-semibold">
            Frequently asked questions about {service.name.toLowerCase()} in{" "}
            {city.label}
          </h2>
        </div>
        <div class="mt-4 space-y-3">
          {faqItems.map((faq) => (
            <details class="group bg-cf-sandSoft text-cf-text shadow-soft rounded-2xl p-4 text-sm">
              <summary class="flex cursor-pointer items-center justify-between gap-3">
                <span class="font-semibold">{faq.question}</span>
                <span class="text-cf-primary ml-4 inline-flex h-6 w-6 items-center justify-center rounded-full bg-white text-xs font-semibold group-open:rotate-45">
                  +
                </span>
              </summary>
              <p class="text-cf-textMuted mt-2 text-sm">{faq.answer}</p>
            </details>
          ))}
        </div>
      </section>
    )
  }

  {/* BOTTOM CTA */}
  <PageCtaStrip
    eyebrow={`Next steps in ${city.label}`}
    title={`Ready to schedule ${service.name.toLowerCase()} help in ${city.label}?`}
    body={`Share your punch list, preferred timing, and any helpful photos. You will receive clear next steps and a no-obligation estimate for your home in ${city.label}.`}
  />
</BaseLayout>
